{% extends 'base_auth.html' %}

{% block title %}Регистрация{% endblock %}

{% block header_title %}Регистрация <i class="fas fa-user-plus"></i>{% endblock %}

{% block content %}
    <h2 class="auth-title">Создайте аккаунт</h2>
    <p class="auth-subtitle">Заполните форму ниже, чтобы начать</p>

    {% if form.errors %}
        <div class="error-message">
            Пожалуйста, исправьте ошибки в форме:
            <ul class="mb-0 mt-2">
                {% for field, errors in form.errors.items %}
                    {% for error in errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="post" action="{% url 'register' %}">
        {% csrf_token %}
        <div class="form-floating mb-3">
            <input type="text" name="username" class="form-control" id="username" placeholder="Имя пользователя" required>
            <label for="username">Имя пользователя</label>
        </div>
        <div class="form-floating mb-3">
            <input type="email" name="email" class="form-control" id="email" placeholder="Email" required>
            <label for="email">Email</label>
        </div>
        <div class="form-floating mb-3">
            <input type="password" name="password1" class="form-control" id="password1" placeholder="Пароль" required>
            <label for="password1">Пароль</label>
        </div>
        <div class="form-floating mb-4">
            <input type="password" name="password2" class="form-control" id="password2" placeholder="Подтверждение пароля" required>
            <label for="password2">Подтверждение пароля</label>
        </div>
        <button type="submit" class="btn btn-auth w-100">Зарегистрироваться</button>
    </form>

    <div class="auth-links">
        <p>Уже есть аккаунт? <a href="{% url 'login' %}">Войти</a></p>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    // Добавляем анимацию при наведении на поля ввода
    document.querySelectorAll('.form-floating').forEach(field => {
        field.addEventListener('mouseover', () => {
            field.style.transform = 'translateX(5px)';
            field.style.transition = 'transform 0.3s ease';
        });
        field.addEventListener('mouseout', () => {
            field.style.transform = 'translateX(0)';
        });
    });

    // Проверка совпадения паролей
    const password1 = document.getElementById('password1');
    const password2 = document.getElementById('password2');
    const form = document.querySelector('form');

    function validatePasswords() {
        if (password2.value && password1.value !== password2.value) {
            password2.setCustomValidity('Пароли не совпадают');
        } else {
            password2.setCustomValidity('');
        }
    }

    password1.addEventListener('change', validatePasswords);
    password2.addEventListener('keyup', validatePasswords);
</script>
{% endblock %}
